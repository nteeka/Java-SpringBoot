<div th:replace="/ViewLayout/header.html"></div>


<div class="p-5 bg-primary text-white text-center">
	<h1 th:text="${c.className}"></h1>
	<p>Chào mừng bạn tham gia vào lớp!</p>
</div>

<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
	<div class="container-fluid">
		<ul class="navbar-nav">
			<li class="nav-item"><a class="nav-link active"
				th:href="'/Class/enterClass/' + ${id}">Lobby</a></li>
			<li th:if="${c.account.accountId == session.loggedInUser.accountId}"
				class="nav-item dropdown"><a class="nav-link dropdown-toggle"
				href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
				aria-expanded="false"> Create </a>
				<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
					<li><a id="createNotifyBtn" class="dropdown-item" href="#">Notify</a></li>
					<li><a id="createHomeworkBtn" class="dropdown-item" href="#">Homework</a></li>
				</ul></li>

			<li class="nav-item"><a class="nav-link"
				th:href="'/Homework/listHomework/' + ${id}">Homework</a></li>
			<li class="nav-item"><a class="nav-link"
				th:href="'/Notify/listNoti/' + ${id}">Notify</a></li>
			<li class="nav-item"><a class="nav-link disabled" href="#">Disabled</a>
			</li>
		</ul>
	</div>
</nav>

<div class="container bootstrap snippets bootdey">
    <div class="table-responsive">
    	<!-- PROJECT TABLE -->
    	<table class="table colored-header datatable project-list">
    <thead>
        <tr>
            <th>Member</th>
            <th>Date Submited</th>
            <th>Status</th>
            <th>Files</th>
            <th>Point</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        <tr th:each="submit : ${listSubmited}">
            <td>
                <img th:src="${submit.account.image}" alt="Avatar" class="avatar img-circle">
                <a href="#">
                    <span th:text="${submit.account.displayName}"></span>
                </a>
            </td>
            <td>
                <span th:text="${#temporals.format(submit.dateSubmited, 'dd/MM/yyyy HH:mm')}"></span>
            </td>
            <td th:if="${submit.status}">
                <span style="color: green;">ON TIME</span>
            </td>
            <td th:if="${!submit.status}">
                <span style="color: red;">LATE</span>
            </td>
	
           	<td>
			    <ul>			        
			        <li th:each="fileUrl : ${listFile}" th:if="${fileUrl.submitHomework != null and fileUrl.submitHomework.submitHomeworkId == submit.submitHomeworkId}" >
			            <a th:href="${fileUrl.filePath}"><span th:text="${fileUrl.filePath}"></span></a>
			        </li>
			    </ul>
			</td>

            <td>
                <span>_/10</span>
            </td>
            <td>
                <div class="btn-group">
                    <a class="btn btn-primary" href="#">Give point</a>
                    <a class="btn btn-info" href="#">See detail</a>
                </div>
            </td>
        </tr>
    </tbody>
</table>


<script>
    document.addEventListener("DOMContentLoaded", function() {
        var fileSpans = document.querySelectorAll("ul li span");
        fileSpans.forEach(function(fileSpan) {
            var url = fileSpan.textContent; // Lấy nội dung của thẻ span, tức là URL
            var filename = url.substring(url.lastIndexOf('/') + 1);
            var regex = /.*?_submitHomework_/; // Biểu thức chính quy để tìm phần tiền tố
            filename = filename.replace(regex, ''); // Loại bỏ phần tiền tố từ tên file
            fileSpan.textContent = filename; // Thay đổi nội dung của thẻ span thành tên file
        });
    });
</script>
    	<!-- END PROJECT TABLE -->
    </div>
</div>


<div id="homeworkModal" class="modal">
	<div class="modal-dialog">
		<div class="modal-content">

			<!-- Modal Header -->
			<div
				style="text-align: center; display: flex; justify-content: center;"
				class="modal-header">
				<h4 class="modal-title">Create Homework</h4>
			</div>

			<!-- Modal Body -->
			<div class="modal-body">
				<div class="alert alert-danger" th:if="${errorDeadline}">
					<p th:text="${errorDeadline}"></p>
				</div>
				<form action="/Homework/createHomework" id="homeworkForm"
					method="post" enctype="multipart/form-data">
					<div hidden="true" class="form-group">
						<label for="classes">Class</label> <select class="form-control"
							id="classes" name="classes">
							<!-- Iterate over the classes and populate the options -->
							<option th:value="${c.classId}" th:text="${c.className}"></option>
						</select>
					</div>
					<div class="form-group">
						<label for="homeworkName">Name:</label> <input name="homeworkName"
							type="text" class="form-control" id="homeworkName" required>
					</div>
					<div class="form-group">
						<label for="description">Description:</label>
						<textarea name="description" class="form-control"
							id="homeworkDescription" required></textarea>
					</div>
					<div class="form-group form-check">
						<input type="checkbox" class="form-check-input" id="status"
							onclick="toggleDeadline()"> <label
							class="form-check-label" for="status">Set deadline
							(Optional)</label>
					</div>
					<div class="form-group" id="deadlineGroup" style="display: none;">
						<label for="deadline">Deadline:</label> <input name="deadline"
							type="date" class="form-control" id="homeworkDeadline">
					</div>

					<div class="form-group mt-3">
						<label class="mr-2">Upload your homework:</label> <input
							type="file" name="filePath" multiple="multiple">
					</div>
					<div class="form-group mt-3 d-flex justify-content-between">
						<button type="button"
							class="btn btn-secondary closeCreateHomeworkModal"
							data-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-primary">Create</button>
					</div>
				</form>
			</div>

		</div>
	</div>
</div>

<!-- Modals -->
<div id="notifyModal" class="modal">
	<div class="modal-dialog">
		<div class="modal-content">

			<!-- Modal Header -->
			<div
				style="text-align: center; display: flex; justify-content: center;"
				class="modal-header">
				<h4 class="modal-title">Create Notification</h4>
			</div>

			<!-- Modal Body -->
			<div class="modal-body">
				<form action="/Notify/createNotification" id="notifyForm"
					method="post" enctype="multipart/form-data">
					<div hidden="true" class="form-group">
						<label for="classes">Class</label> <select class="form-control"
							id="classes" name="classes">
							<!-- Iterate over the classes and populate the options -->
							<option th:value="${c.classId}" th:text="${c.className}"></option>
						</select>
					</div>
					<div class="form-group">
						<label for="title">Title:</label> <input type="text" name="title"
							class="form-control" id="notifyTitle" required />
					</div>
					<div class="form-group">
						<label for="content">Content:</label>
						<textarea name="content" class="form-control"
							id="notifyDescription" required></textarea>
					</div>

					<div class="form-group mt-3">
						<label class="mr-2">Upload your files(Optional):</label> <input
							type="file" name="filePath" multiple="multiple">
					</div>
					<div class="form-group mt-3 d-flex justify-content-between">
						<button type="button"
							class="btn btn-secondary closeCreateNotifyModal"
							data-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-primary">Create</button>
					</div>

				</form>
			</div>

		</div>
	</div>
</div>
<!-- Notify -->
<script>
	document.getElementById('createNotifyBtn').addEventListener('click',
			function() {
				document.getElementById('notifyModal').style.display = 'block';
			});
	document.querySelectorAll('.closeCreateNotifyModal').forEach(function(el) {
		el.addEventListener('click', function() {
			document.getElementById('notifyModal').style.display = 'none';
		});
	});
</script>
<!-- Notify -->
<!-- Homework -->
<script>
	document
			.getElementById('createHomeworkBtn')
			.addEventListener(
					'click',
					function() {
						document.getElementById('homeworkModal').style.display = 'block';
					});
	document
			.querySelectorAll('.closeCreateHomeworkModal')
			.forEach(
					function(el) {
						el
								.addEventListener(
										'click',
										function() {
											document
													.getElementById('homeworkModal').style.display = 'none';
										});
					});
	function toggleDeadline() {
		var statusCheckbox = document.getElementById("status");
		var deadlineGroup = document.getElementById("deadlineGroup");

		if (statusCheckbox.checked) {
			deadlineGroup.style.display = "block"; // Hiển thị trường Deadline
		} else {
			deadlineGroup.style.display = "none"; // Ẩn trường Deadline
		}
	}
</script>








<style>
.container bootstrap snippets bootdey {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  color: #555;
  background: #ececec;
  margin-top:20px;
}

.project-list > tbody > tr > td {
  padding: 12px 8px;
}

.project-list > tbody > tr > td .avatar {
  width: 22px;
  border: 1px solid #CCC;
}
</style>






<div th:replace="/ViewLayout/footer.html"></div>
