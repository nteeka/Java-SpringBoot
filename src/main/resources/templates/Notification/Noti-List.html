<div th:replace="/ViewLayout/header.html"></div>
<style>
.fakeimg {
	height: 200px;
	background: #aaa;
}
</style>
<div class="p-5 bg-primary text-white text-center">
	<h1 th:text="${c.className}"></h1>
	<p>Chào mừng bạn tham gia vào lớp!</p>
</div>

<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
	<div class="container-fluid">
		<ul class="navbar-nav">
			<li class="nav-item"><a class="nav-link active"
				th:href="'/Class/enterClass/' + ${idClass}">Lobby</a></li>
			<li th:if="${c.account.accountId == session.loggedInUser.accountId}"
				class="nav-item dropdown"><a class="nav-link dropdown-toggle"
				href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
				aria-expanded="false"> Create </a>
				<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
					<li><a id="createNotifyBtn" class="dropdown-item" href="#">Notify</a></li>
					<li><a id="createHomeworkBtn" class="dropdown-item" href="#">Homework</a></li>
				</ul></li>

			<li class="nav-item"><a class="nav-link"
				th:href="'/Homework/listHomework/' + ${c.classId}">Homework</a></li>
			<li class="nav-item"><a class="nav-link"
				th:href="'/Notify/listNoti/' + ${c.classId}">Notify</a></li>
			
			<li th:if="${account.accountId != c.account.accountId}" class="nav-item"><a class="nav-link leave-class-btn" href="#" th:data-class-id="${c.classId}">Leave class</a>
			</li>
		</ul>
	</div>
</nav>
<div id="errorDiv" class="alert alert-danger" th:if="${errorEmptyFile}">
	<p th:text="${errorEmptyFile}"></p>
</div>
<div id="successDiv" class="alert alert-success" th:if="${createNotiSuccess}">
		<p th:text="${createNotiSuccess}"></p>
	</div>
	<div id="successDiv" class="alert alert-success" th:if="${updateNotiSuccess}">
		<p th:text="${updateNotiSuccess}"></p>
	</div>
	<div id="successDiv" class="alert alert-success" th:if="${pinNotiSuccess}">
		<p th:text="${pinNotiSuccess}"></p>
	</div>
	<div id="successDiv" class="alert alert-success" th:if="${unPinNotiSuccess}">
		<p th:text="${unPinNotiSuccess}"></p>
	</div>
<div th:if="!${listNoti}">List noti is empty - Let's create one !!</div>
<div th:if="${listNoti}" style="margin-top: 20px" class="container">
	<a id="createNotifyBtn2" class="btn btn-primary" href="#">Create
		Notify</a>

	<div style="margin-top: 10px" class="row">

		<div th:each="noti : ${listNoti}" class="col-lg-4">
			<div class="card card-margin" th:classappend="${noti.isPinned} ? 'bg-primary' : ''">

				<div class="card-header no-border">
					<h5 class="card-title" th:text="${noti.account.displayName}"></h5>
					<a th:if="${noti.account.accountId == session.loggedInUser.accountId}" th:href="'/Notify/editNoti/' + ${noti.notifyId}" class="btn btn-default">Edit<i class="fa fa-pencil"></i></a>
				</div>
				<div class="card-body pt-0">
					<div class="widget-49">
						<div class="widget-49-title-wrapper">
							<div class="widget-49-date-primary">
								<span class="widget-49-date-day"
									th:text="${#temporals.format(noti.dateCreated, 'dd')}"></span>
								<span class="widget-49-date-month"
									th:text="${#temporals.format(noti.dateCreated, 'MMM')}"></span>
							</div>
							<div class="widget-49-meeting-info">
								<span class="widget-49-pro-title" th:text="${noti.title}"></span>
								<span class="widget-49-meeting-time">Nhãn dán</span>
							</div>
						</div>

						<div class="widget-49-meeting-action">
							<a th:if="${noti.isPinned}") th:href="@{'/Notify/pinNoti/' + ${noti.notifyId}}"
								class="btn btn-sm btn-flash-border-primary">Unpin on lobby</a>
							<a th:unless="${noti.isPinned}") th:href="@{'/Notify/pinNoti/' + ${noti.notifyId}}"
								class="btn btn-sm btn-flash-border-primary">Pin on lobby</a>	
							<a th:href="@{'/Notify/detailNoti/' + ${noti.notifyId}}"
								class="btn btn-sm btn-flash-border-primary">View Detail</a>
						</div>
					</div>
				</div>
			</div>
		</div>


	</div>
</div>
<style>
.card-margin {
	margin-bottom: 1.875rem;
}

.card {
	border: 0;
	box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
	-webkit-box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
	-moz-box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
	-ms-box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
}

.card {
	position: relative;
	display: flex;
	flex-direction: column;
	min-width: 0;
	word-wrap: break-word;
	background-color: #ffffff;
	background-clip: border-box;
	border: 1px solid #e6e4e9;
	border-radius: 8px;
}

.card .card-header.no-border {
	border: 0;
}

.card .card-header {
	background: none;
	padding: 0 0.9375rem;
	font-weight: 500;
	display: flex;
	align-items: center;
	min-height: 50px;
}

.card-header:first-child {
	border-radius: calc(8px - 1px) calc(8px - 1px) 0 0;
}

.widget-49 .widget-49-title-wrapper {
	display: flex;
	align-items: center;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-primary {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: #edf1fc;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-primary .widget-49-date-day
	{
	color: #4e73e5;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-primary .widget-49-date-month
	{
	color: #4e73e5;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-secondary {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: #fcfcfd;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-secondary .widget-49-date-day
	{
	color: #dde1e9;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-secondary .widget-49-date-month
	{
	color: #dde1e9;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-success {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: #e8faf8;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-success .widget-49-date-day
	{
	color: #17d1bd;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-success .widget-49-date-month
	{
	color: #17d1bd;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-info {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: #ebf7ff;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-info .widget-49-date-day
	{
	color: #36afff;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-info .widget-49-date-month
	{
	color: #36afff;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-warning {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: floralwhite;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-warning .widget-49-date-day
	{
	color: #FFC868;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-warning .widget-49-date-month
	{
	color: #FFC868;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-danger {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: #feeeef;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-danger .widget-49-date-day
	{
	color: #F95062;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-danger .widget-49-date-month
	{
	color: #F95062;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-light {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: #fefeff;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-light .widget-49-date-day
	{
	color: #f7f9fa;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-light .widget-49-date-month
	{
	color: #f7f9fa;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-dark {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: #ebedee;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-dark .widget-49-date-day
	{
	color: #394856;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-dark .widget-49-date-month
	{
	color: #394856;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-base {
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	background-color: #f0fafb;
	width: 4rem;
	height: 4rem;
	border-radius: 50%;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-base .widget-49-date-day
	{
	color: #68CBD7;
	font-weight: 500;
	font-size: 1.5rem;
	line-height: 1;
}

.widget-49 .widget-49-title-wrapper .widget-49-date-base .widget-49-date-month
	{
	color: #68CBD7;
	line-height: 1;
	font-size: 1rem;
	text-transform: uppercase;
}

.widget-49 .widget-49-title-wrapper .widget-49-meeting-info {
	display: flex;
	flex-direction: column;
	margin-left: 1rem;
}

.widget-49 .widget-49-title-wrapper .widget-49-meeting-info .widget-49-pro-title
	{
	color: #3c4142;
	font-size: 14px;
}

.widget-49 .widget-49-title-wrapper .widget-49-meeting-info .widget-49-meeting-time
	{
	color: #B1BAC5;
	font-size: 13px;
}

.widget-49 .widget-49-meeting-points {
	font-weight: 400;
	font-size: 13px;
	margin-top: .5rem;
}

.widget-49 .widget-49-meeting-points .widget-49-meeting-item {
	display: list-item;
	color: #727686;
}

.widget-49 .widget-49-meeting-points .widget-49-meeting-item span {
	margin-left: .5rem;
}

.widget-49 .widget-49-meeting-action {
	text-align: right;
}

.widget-49 .widget-49-meeting-action a {
	text-transform: uppercase;
}
</style>



<!-- Modals -->
<div id="notifyModal" class="modal">
	<div class="modal-dialog">
		<div class="modal-content">

			<!-- Modal Header -->
			<div
				style="text-align: center; display: flex; justify-content: center;"
				class="modal-header">
				<h4 class="modal-title">Create Notification</h4>
			</div>

			<!-- Modal Body -->
			<div class="modal-body">
				<form action="/Notify/createNotification" id="notifyForm"
					method="post" enctype="multipart/form-data">
					<div hidden="true" class="form-group">
						<label for="classes">Class</label> <select class="form-control"
							id="classes" name="classes">
							<!-- Iterate over the classes and populate the options -->
							<option th:value="${idClass}" th:text="${nameClass}"></option>
						</select>
					</div>
					<div class="form-group">
						<label for="title">Title:</label> <input type="text" name="title"
							class="form-control" id="notifyTitle" required />
					</div>
					<div class="form-group">
						<label for="content">Content:</label>
						<textarea name="content" class="form-control"
							id="notifyDescription" required></textarea>
					</div>

					<div class="form-group mt-3">
						<label class="mr-2">Upload your files(Optional):</label> <input
							type="file" name="filePath" multiple="multiple">
					</div>
					<div class="form-group mt-3 d-flex justify-content-between">
						<button type="button"
							class="btn btn-secondary closeCreateNotifyModal"
							data-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-primary">Create</button>
					</div>

				</form>
			</div>

		</div>
	</div>
</div>

<div id="homeworkModal" class="modal">
	<div class="modal-dialog">
		<div class="modal-content">

			<!-- Modal Header -->
			<div
				style="text-align: center; display: flex; justify-content: center;"
				class="modal-header">
				<h4 class="modal-title">Create Homework</h4>
			</div>

			<!-- Modal Body -->
			<div class="modal-body">
				<div class="alert alert-danger" th:if="${errorDeadline}">
					<p th:text="${errorDeadline}"></p>
				</div>
				<form action="/Homework/createHomework" id="homeworkForm"
					method="post" enctype="multipart/form-data">
					<div hidden="true" class="form-group">
						<label for="classes">Class</label> <select class="form-control"
							id="classes" name="classes">
							<!-- Iterate over the classes and populate the options -->
							<option th:value="${idClass}" th:text="${nameClass}"></option>
						</select>
					</div>
					<div class="form-group">
						<label for="homeworkName">Name:</label> <input name="homeworkName"
							type="text" class="form-control" id="homeworkName" required>
					</div>
					<div class="form-group">
						<label for="description">Description:</label>
						<textarea name="description" class="form-control"
							id="homeworkDescription" required></textarea>
					</div>
					<div class="form-group form-check">
						<input type="checkbox" class="form-check-input" id="status"
							onclick="toggleDeadline()"> <label
							class="form-check-label" for="status">Set deadline
							(Optional)</label>
					</div>
					<div class="form-group" id="deadlineGroup" style="display: none;">
						<label for="deadline">Deadline:</label> <input name="deadline"
							type="date" class="form-control" id="homeworkDeadline">
					</div>

					<div class="form-group mt-3">
						<label class="mr-2">Upload your homework:</label> <input
							type="file" name="filePath" multiple="multiple">
					</div>
					<div class="form-group mt-3 d-flex justify-content-between">
						<button type="button"
							class="btn btn-secondary closeCreateHomeworkModal"
							data-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-primary">Create</button>
					</div>
				</form>
			</div>

		</div>
	</div>
</div>

<!-- Modals -->

<!-- Scripts -->


<!-- Notify -->
<script>
	document.getElementById('createNotifyBtn').addEventListener('click',
			function() {
				document.getElementById('notifyModal').style.display = 'block';
			});
	document.getElementById('createNotifyBtn2').addEventListener('click',
			function() {
				document.getElementById('notifyModal').style.display = 'block';
			});
	document.querySelectorAll('.closeCreateNotifyModal').forEach(function(el) {
		el.addEventListener('click', function() {
			document.getElementById('notifyModal').style.display = 'none';
		});
	});
</script>
<!-- Notify -->

<!-- Homework -->
<script>
	document
			.getElementById('createHomeworkBtn')
			.addEventListener(
					'click',
					function() {
						document.getElementById('homeworkModal').style.display = 'block';
					});
	document
			.querySelectorAll('.closeCreateHomeworkModal')
			.forEach(
					function(el) {
						el
								.addEventListener(
										'click',
										function() {
											document
													.getElementById('homeworkModal').style.display = 'none';
										});
					});
	function toggleDeadline() {
		var statusCheckbox = document.getElementById("status");
		var deadlineGroup = document.getElementById("deadlineGroup");

		if (statusCheckbox.checked) {
			deadlineGroup.style.display = "block"; // Hiển thị trường Deadline
		} else {
			deadlineGroup.style.display = "none"; // Ẩn trường Deadline
		}
	}
</script>
<script th:inline="javascript">
	/*<![CDATA[*/
	/* Thymeleaf variable to check if there is an error */
	var hasError = /*[[${errorDeadline != null}]]*/false;

	/* If there is an error, show the modal again */
	if (hasError) {
		$(document).ready(function() {
			$('#homeworkModal').modal('show');
		});
	}
	/*]]>*/
</script>
<script>
    // Hàm để ẩn đi phần tử sau một khoảng thời gian
    function hideElementAfterDelay(elementId, delay) {
        setTimeout(function() {
            var element = document.getElementById(elementId);
            if (element) {
                element.style.display = 'none';
            }
        }, delay);
    }

    // Gọi hàm để ẩn đi phần tử sau 3 giây (3000 milliseconds)
    hideElementAfterDelay('errorDiv', 3000);
    hideElementAfterDelay('successDiv', 3000);
</script>
<!-- Homework -->






<div th:replace="/ViewLayout/footer.html"></div>
